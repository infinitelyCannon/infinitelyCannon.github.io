<!DOCTYPE html>
<!--
	Editorial by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="/assets/css/main.css" />
		<link rel="stylesheet" href="/assets/css/photoswipe.css" />
		<link rel="stylesheet" href="/assets/css/default-skin/default-skin.css" />
		<link rel="stylesheet" media="screen and (prefers-color-scheme: light)" href="/assets/css/atom-one-light.css" />
		<link rel="stylesheet" media="screen and (prefers-color-scheme: dark)" href="/assets/css/atom-one-dark.css" />
		<title>Catformer</title>
		<link rel="icon" type="image/x-icon" href="/assets/favicon.ico" />
		<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Catformer | Dakarai Simmons</title>
<meta name="generator" content="Jekyll v4.2.2" />
<meta property="og:title" content="Catformer" />
<meta name="author" content="Dakarai Simmons" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Catformer is an infinite scrolling 2D platformer. With it’s one-finger mechanic the challenge is to climb as high up as possible while dodging hazards. This was a one semester, six-team project." />
<meta property="og:description" content="Catformer is an infinite scrolling 2D platformer. With it’s one-finger mechanic the challenge is to climb as high up as possible while dodging hazards. This was a one semester, six-team project." />
<link rel="canonical" href="https://dakar.ai/projects/catformer.html" />
<meta property="og:url" content="https://dakar.ai/projects/catformer.html" />
<meta property="og:site_name" content="Dakarai Simmons" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Catformer" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","author":{"@type":"Person","name":"Dakarai Simmons"},"description":"Catformer is an infinite scrolling 2D platformer. With it’s one-finger mechanic the challenge is to climb as high up as possible while dodging hazards. This was a one semester, six-team project.","headline":"Catformer","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://dakar.ai/assets/img/infinitelyCannon.600x600.png"},"name":"Dakarai Simmons"},"url":"https://dakar.ai/projects/catformer.html"}</script>
<!-- End Jekyll SEO tag -->

    </head>
    <body onload="Setup(event)">
        <div id="wrapper">
			<div id="main">
				<div class="inner">
					<header>
	<img src="/assets/img/infinitelyCannon.svg" />
    <div id="header">
		<a class="logo" href="/index.html">
			<strong>Dakarai Simmons</strong> | Portfolio Site
		</a>
		<ul class="icons">
			
			
			
			<li>
				<a href="https://github.com/infinitelycannon" title="GitHub" target="_blank" class="icon brands">
					<span class="iconify" data-icon="mdi-github"></span>
				</a>
			</li>
			
			
			
			<li>
				<a href="https://www.linkedin.com/in/dakarai-simmons-a23787132/" title="Linkedin" target="_blank" class="icon brands">
					<span class="iconify" data-icon="mdi-linkedin"></span>
				</a>
			</li>
			
			
			<li>
				<a href="mailto:dakar0416@gmail.com" title="Email" target="_blank" class="icon brands">
					<span class="iconify" data-icon="mdi-email"></span>
				</a>
			</li>
			
			
			<li>
				<a href="/assets/DakaraiSimmons_Resume.pdf" title="Resume" target="_blank" class="icon brands">
					<span class="iconify" data-icon="mdi-file-pdf"></span>
				</a>
			</li>
			
		</ul>
	</div>
</header>
					<section>
    <header class="main">
        <h1>Catformer</h1>
    </header>
    <p>Catformer is an infinite scrolling 2D platformer. With it’s one-finger mechanic the challenge is to climb as high up as possible while dodging hazards. This was a one semester, six-team project.</p>

<div class="row">
	<div class="gallery col-12" is-grid>
		
<a class="image"  use-background="true" data-med="/assets/img/catformer/cat0.720x1280.jpg" data-med-size="720x1280">
	
	<img class="gallery-image" style="background-image: url('/assets/img/catformer/cat0.720x1280.jpg');" />
	
	<span></span>
</a>
		
<a class="image"  use-background="true" data-med="/assets/img/catformer/cat1.720x1280.jpg" data-med-size="720x1280">
	
	<img class="gallery-image" style="background-image: url('/assets/img/catformer/cat1.720x1280.jpg');" />
	
	<span></span>
</a>
		
<a class="image"  use-background="true" data-med="/assets/img/catformer/cat2.720x1280.jpg" data-med-size="720x1280">
	
	<img class="gallery-image" style="background-image: url('/assets/img/catformer/cat2.720x1280.jpg');" />
	
	<span></span>
</a>
		
<a class="image"  use-background="true" data-med="/assets/img/catformer/cat3.720x1280.jpg" data-med-size="720x1280">
	
	<img class="gallery-image" style="background-image: url('/assets/img/catformer/cat3.720x1280.jpg');" />
	
	<span></span>
</a>
		
<a class="image"  use-background="true" data-med="/assets/img/catformer/cat4.720x1280.jpg" data-med-size="720x1280">
	
	<img class="gallery-image" style="background-image: url('/assets/img/catformer/cat4.720x1280.jpg');" />
	
	<span></span>
</a>
		
<a class="image"  use-background="true" data-med="/assets/img/catformer/cat5.720x1280.jpg" data-med-size="720x1280">
	
	<img class="gallery-image" style="background-image: url('/assets/img/catformer/cat5.720x1280.jpg');" />
	
	<span></span>
</a>
	</div>
</div>

<br />
<h2>Level Building</h2>

<div class="row">
	<div class="col-4">
		<div class="video-display">
			<video controls muted autoplay loop>
				<source src="/assets/vid/cat/background-scroll.1592x984.mp4" type="video/mp4">
			</video>
			<span>A test run of the background prefab</span>
		</div>
	</div>
	<div class="col-8">
		<p>
			The team decided the progression of the level would involve different environmental stages that loop a certain number of times before transitioning to the next one. So my first responsibility was to make a prefab with adjustable properties:<br/>
			&emsp;&emsp;&bull;	The speed for each layer<br />
			&emsp;&emsp;&bull;	The total number of stages<br />
			&emsp;&emsp;&bull;	The sprites for each layer<br />
			&emsp;&emsp;&bull;	How many times each stage would loop before the next one<br />
			The background code also handled the task of scaling the sprites so their width matched the screen.
		</p>
	</div>
</div>

<h2>Platforming</h2>

<p>There are three types of platforms the player jumps on depending on the stage they’re in and the system for this spawns them randomly with a check that prevents players from relying on one pattern to guarantee a safe upward path.</p>

<div class="row">
	<div class="col-4">
		<div class="video-display">
			<video controls muted autoplay loop>
				<source src="/assets/vid/cat/particle-pooling.1382x1032.mp4" type="video/mp4">
			</video>
			<span>Demonstration of recycling platforms</span>
		</div>
	</div>
	<div class="col-8">
		<p>The platforms themselves are managed by a pooling system. A fixed list of platforms are instantiated at the beginning (based on the highest observed number of active platforms), and then disappearing platforms are queued to reuse when spawning new ones. To make platforms reusable, I saved the common data between them into a scriptable object, which the parent spawner passes into one platform prefab. One difficult part of this was how every platform has a particle effect attached to it, but particle system components can’t be referenced individually like sprites or numbers. To address this, we saved a prefab with the particle system attached to it, then the platform’s script would mirror the properties over using C#’s reflection system.</p>
	</div>
</div>

<br />
<strong>Reflection Loops</strong>
<pre>
	<code class="language-csharp">
// The property info for the ParticleSystem class type and the saved instance
PropertyInfo[] particleProps = particles.GetType().GetProperties();
ParticleSystem savedSystem = data.ParticlePrefab.GetComponent&lt;ParticleSystem&gt;();

// For each property in this class,
foreach (var property in particleProps)
{
	// Grab each particle module (except subemitters which aren't used)
	if(property.PropertyType.Name.Contains("Module") &amp;&amp; !property.PropertyType.Name.Contains("SubEmitters"))
	{
		// Grab the corresponding module object on this GameObject, grab its properties,
		object module = property.GetValue(particles);
		PropertyInfo[] properties = module.GetType().GetProperties();
		object newModule = savedSystem.GetType().GetProperty(property.Name).GetValue(savedSystem);

		// Then loop through these properties and set them to the value from the prefab object.
		foreach (var prop in properties)
			if(prop.GetIndexParameters().Length == 0 &amp;&amp; prop.CanWrite)
				prop.SetValue(module, prop.GetValue(newModule));
	}
}

// Repeat the process for the ParticleSystemRenderer.
ParticleSystemRenderer renderer = GetComponentInChildren&lt;ParticleSystemRenderer&gt;(),
	savedRenderer = data.ParticlePrefab.GetComponent&lt;ParticleSystemRenderer&gt;();
particleProps = renderer.GetType().GetProperties();

foreach(var property in particleProps)
{
	if(property.GetIndexParameters().Length == 0 &amp;&amp; property.CanRead &amp;&amp; property.CanWrite &amp;&amp; !property.Name.Contains("materials", true))
	{
		if (property.Name.Contains("material", true) &amp;&amp; !property.Name.Equals("sharedMaterial"))
			continue;
		property.SetValue(renderer, property.GetValue(savedRenderer));
	}
}
	</code>
</pre>

<script>
	window.OnSetup = window.OnSetup || [];

	function ResizeVideo()
	{
		var videos = $("video");
			
			for(var i = 0; i < videos.length; ++i)
			{
				var width = $(videos[i]).parent().width();
				var src = $(videos[i]).children("source").attr("src").split(".")[1].split("x");
				var aspect = parseInt(src[1]) / parseInt(src[0]);
				$(videos[i]).width(width);
				$(videos[i]).height(aspect * width);
			}
	}

	window.OnSetup.push(function(event)
	{
		$(window).on("resize", ResizeVideo);
		ResizeVideo();
	});
</script>

<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo https://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>

<script>
    window.OnSetup = window.OnSetup || [];

	window.OnSetup.push(function(event)
    {
		var galleryElements = $(".gallery");

		for(var i = 0; i < galleryElements.length; ++i)
		{
			galleryElements[i].setAttribute("data-pswp-uid", i+1);
		}

		$(".gallery > a").click(function(e){
			e.preventDefault();

			var items = [],
			parent = $(this).parent(),
			index = parent.children().index(this),
			links = parent.children("a.image");

			var options = {
				index: index,
				shareEl: false,
				bgOpacity: 0.75,
				galleryUID: parent.attr("data-pswp-uid")
			};

			for(var j = 0; j < links.length; ++j)
			{
				var size = $(links[j]).attr("data-med-size").split('x');
				var item = {};

				item.w = parseInt(size[0], 10);
				item.h = parseInt(size[1], 10);
                if($(links[j]).attr("has-thumb") == "true")
                {
                    item.msrc = $(links[j]).attr("use-background") == "true" ? 
                    $(links[j]).children("img").css("background-image").split("\"")[1] :
                    $(links[j]).children("img").attr("src");
                    item.src = $(links[j]).attr("data-med");
                }
                else
                {
                    item.src = $(links[j]).attr("data-med");
                }
				item.title = $(links[j]).children("span")[0].innerHTML;

				items.push(item);
			}

			var gallery = new PhotoSwipe($(".pswp")[0], PhotoSwipeUI_Default, items, options);
			gallery.init();
		});
	});
</script>
</section>
				</div>
			</div>
		</div>
		<script src="/assets/js/photoswipe.min.js"></script>
		<script src="/assets/js/photoswipe-ui-default.min.js"></script>
		<script src="https://code.iconify.design/1/1.0.7/iconify.min.js"></script>
		<script src="/assets/js/jquery.min.js"></script>
		<script src="/assets/js/browser.min.js"></script>
		<script src="/assets/js/breakpoints.min.js"></script>
		<script src="/assets/js/util.js"></script>
		<script src="/assets/js/main.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.7.1/highlight.min.js"></script>
		<script>
			function Setup(e)
			{
				hljs.highlightAll();
				if(window.OnSetup != undefined && window.OnSetup.length > 0)
				{
					for(var i = 0; i < window.OnSetup.length; ++i)
						window.OnSetup[i](e);
				}
			}

			function ClearMigrate()
			{
				$("#migrate-msg").removeClass("from-github");
			}
		</script>
    </body>
</html>